/*! jSmarty 2014-03-21 */
(function(e){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t,"node")}else"function"==typeof define&&define.amd?define(["exports"],e):e(window.NC={})})(function(exports,env){function escapeRegExp(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function removeUnsafe(e){var t=e.replace(/([\r\n])/gi,"\\n").replace(/\s{2,}/gi," ").replace(/\'/gi,"\\'");return t}function strtotime(e,t){function r(e,t,r){var a,n=c[t];n!==void 0&&(a=n-u.getDay(),0===a?a=7*r:a>0&&"last"===e?a-=7:0>a&&"next"===e&&(a+=7),u.setDate(u.getDate()+a))}function a(e){var t=e.split(" "),a=t[0],n=t[1].substring(0,3),s=/\d+/.test(a),i="ago"===t[2],o=("last"===a?-1:1)*(i?-1:1);if(s&&(o*=parseInt(a,10)),h.hasOwnProperty(n)&&!t[1].match(/^mon(day|\.)?$/i))return u["set"+h[n]](u["get"+h[n]]()+o);if("wee"===n)return u.setDate(u.getDate()+7*o);if("next"===a||"last"===a)r(a,n,o);else if(!s)return!1;return!0}var n,s,i,o,u,c,h,f,p,l,d,g=!1;if(!e)return g;if(e=e.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase(),s=e.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/),s&&s[2]===s[4])if(s[1]>1901)switch(s[2]){case"-":return s[3]>12||s[5]>31?g:new Date(s[1],parseInt(s[3],10)-1,s[5],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3;case".":return g;case"/":return s[3]>12||s[5]>31?g:new Date(s[1],parseInt(s[3],10)-1,s[5],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3}else if(s[5]>1901)switch(s[2]){case"-":return s[3]>12||s[1]>31?g:new Date(s[5],parseInt(s[3],10)-1,s[1],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3;case".":return s[3]>12||s[1]>31?g:new Date(s[5],parseInt(s[3],10)-1,s[1],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3;case"/":return s[1]>12||s[3]>31?g:new Date(s[5],parseInt(s[1],10)-1,s[3],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3}else switch(s[2]){case"-":return s[3]>12||s[5]>31||70>s[1]&&s[1]>38?g:(o=s[1]>=0&&38>=s[1]?+s[1]+2e3:s[1],new Date(o,parseInt(s[3],10)-1,s[5],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3);case".":return s[5]>=70?s[3]>12||s[1]>31?g:new Date(s[5],parseInt(s[3],10)-1,s[1],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3:60>s[5]&&!s[6]?s[1]>23||s[3]>59?g:(i=new Date,new Date(i.getFullYear(),i.getMonth(),i.getDate(),s[1]||0,s[3]||0,s[5]||0,s[9]||0)/1e3):g;case"/":return s[1]>12||s[3]>31||70>s[5]&&s[5]>38?g:(o=s[5]>=0&&38>=s[5]?+s[5]+2e3:s[5],new Date(o,parseInt(s[1],10)-1,s[3],s[6]||0,s[7]||0,s[8]||0,s[9]||0)/1e3);case":":return s[1]>23||s[3]>59||s[5]>59?g:(i=new Date,new Date(i.getFullYear(),i.getMonth(),i.getDate(),s[1]||0,s[3]||0,s[5]||0)/1e3)}if("now"===e)return null===t||isNaN(t)?0|(new Date).getTime()/1e3:0|t;if(!isNaN(n=Date.parse(e)))return 0|n/1e3;if(u=t?new Date(1e3*t):new Date,c={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},h={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"},p="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)",l="([+-]?\\d+\\s"+p+"|"+"(last|next)\\s"+p+")(\\sago)?",s=e.match(RegExp(l,"gi")),!s)return g;for(d=0,f=s.length;f>d;d++)if(!a(s[d]))return g;return u.getTime()/1e3}function number_format(e,t,r,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,i=a===void 0?",":a,o=r===void 0?".":r,u="",c=function(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r};return u=(s?c(n,s):""+Math.round(n)).split("."),u[0].length>3&&(u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),s>(u[1]||"").length&&(u[1]=u[1]||"",u[1]+=Array(s-u[1].length+1).join("0")),u.join(o)}function fetch(e,t,r){var a,n="";a=fs.getContentText(e);for(var s=/<!--\s*template\s*-->([\s|\S]*?)<!--\s*\/template\s*-->/gi,i=a.match(s);i=s.exec(a);)n+=i[1];var n=filter.HTMLFilter(n,e,t,r);return n}function Parser(e,t){this._tokens=e,this._output="",this._vars=t||{}}var strftime=function(){function e(t,a){return(a+"").replace(/%([a-zA-Z ])/g,function(a,n){var s=r&&r[n];return"function"==typeof s?s.call(r,t):"string"==typeof s?e(s):n})}function t(e){return(10>+e?"0":"")+e}var r={d:function(e){return t(e.getDate())},m:function(e){return t(e.getMonth()+1)},y:function(e){return e.getYear()%100},Y:function(e){return e.getFullYear()},F:"%Y-%m-%d",D:"%m/%d/%y"};return e}(),nc=exports!==void 0?exports:{},fs,path,filter,util;"node"==env&&(fs=require("./file"),path=require("path"),filter=require("./pages"),util=require("./util"));var ObjProto=Object.prototype,toString=ObjProto.toString,reMarker=function(){this._tokens=[],this._included=[],this._basePath="",this._vars={}};reMarker.prototype.startTag="{",reMarker.prototype.endTag="}",reMarker.prototype.setBasePath=function(e){return this._basePath=e,this},reMarker.prototype.setIncluded=function(e){return this._included.push(e),this},reMarker.prototype.getIncluded=function(){return this._included},reMarker.prototype.parse=function(e){for(var t,r=escapeRegExp(this.startTag)+'(?:\\s*)((?:[\\/\\$"])*[\\w\\*"]+)(?:\\s*)(.*?)(?:\\1*)(?:\\s*)'+escapeRegExp(this.endTag),a=RegExp(r,"gim"),n=[],s=0;t=a.exec(e);)s!=t.index&&n.push({type:"text",value:e.substring(s,t.index),matched:e.substring(s,t.index),index:s}),n.push({type:"expression",expr:t[1],value:t[2],matched:t[0],index:t.index}),s=t.index+t[0].length;return n.push({type:"text",value:e.substring(s),matched:e.substring(s),index:s}),this.parser=new Parser(n,this._vars),this.parser.parse(this)},reMarker.prototype.proc=function(e,t){var r,a;try{this._vars=t,a=this.parse(e),r=Function("$data","$util",a+';return _out.join("");')}catch(n){throw Error("模板解析出错"+n.message)}if(!t)return function(e){var t=$smarty;return r(e,t)};var s=r.call(this,t,$smarty);return s};var $smarty={date_format:function(e,t,r){if(!e&&!r)return"date_format语法错误";var a=e||r;"number"!=typeof a&&(a=strtotime(a));var n=strftime(new Date(a),t||"%Y/%m/%d");return n},truncate:function(e,t,r,a,n){return t=t?t:80,r=null!=r?r:"...",t>=e.length?e:(t-=Math.min(t,r.length),n?e.slice(0,Math.floor(t/2))+r+e.slice(e.length-Math.floor(t/2)):(a||(e=e.slice(0,t+1).replace(/\s+?(\S+)?$/,"")),e.slice(0,t)+r))},"default":function(e,t){return e||t||""},fsize_format:function(e,t,r){t=t||"",r=r||2;var a={TB:1099511627776,GB:1073741824,MB:1048576,KB:1024,B:1},n="";for(var s in a)if(e>a[s]||s==strtoupper(t)){n=number_format(e/a[s],r)+" "+s;break}return n}};$smarty.expr=function(e,t){function r(e){for(var t=[],r=e;n.length>r;r++)n[r].modifier||t.push(n[r].string||n[r].num);return i=r,0!=t.length&&t.unshift(""),t.join(",")}var a=new TextReader(e),n=a.read();if(1>n.length)return e;var s;if(s=n[0].string||n[0].num?n[0].string||n[0].num:t?n[0]["var"]:"$data."+n[0]["var"],n.length>1)for(var i=1;n.length>i;i++){var o=$smarty[n[i].modifier];o&&(s="$util."+n[i].modifier+"("+s+r(i)+")")}return s},$smarty.value=function(e){return"[object Object]"===toString.call(e)||"[object Array]"===toString.call(e)?JSON.stringify(e):e},nc.reMarker=reMarker;var TextReader=function(e){this.inChars=e||"",this.words=[]};TextReader.prototype={start:0,end:0,VAR_REGEXP:/[\w\d_\-\.\[\]\'\"]/i,read:function(){for(var e=this.inChars.length;e>=this.start;this.start++)switch(this.inChars.charAt(this.start)){case"	":case"\r":case" ":break;case"@":continue;case"|":this.start=this.findModifier(this.start+1);continue;case"$":this.start=this.findVariable(this.start+1);continue;case'"':case"'":this.start=this.findString(this.start+1);continue;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this.start=this.findNumber(this.start);continue;case":":continue}return this.words},skip:function(){},checkVariable:function(e){return e.match(this.VAR_REGEXP)},checkModifier:function(e){return":"!=e},findNumber:function(e){for(var t=this.inChars.length,r="",a=e;t>a;a++){var n=this.inChars.charAt(a);if(parseInt(n)!=n){a--;break}r+=n}return this.words.push({num:r}),e+a},findVariable:function(e){for(var t=this.inChars.length,r="",a=e;t>a;a++){var n=this.inChars.charAt(a);if(!this.checkVariable(n)){a--;break}r+=n}return this.words.push({"var":r}),a},findString:function(e){for(var t=this.inChars.length,r="",a=e;t>a;a++){var n=this.inChars.charAt(a);if("'"!=n&&'"'!=n)r+=n;else{if("\\"!=n||"'"!=this.inChars.charAt(a+1)&&'"'!=this.inChars.charAt(a+1)){a--;break}r+="\\'",a++}}return this.words.push({string:"'"+r+"'"}),e+a},findModifier:function(e){for(var t=this.inChars.length,r="",a=e;t>a;a++){var n=this.inChars.charAt(a);if(!this.checkModifier(n)){a--;break}r+=n}return this.words.push({modifier:r}),a}};var VAR_REGEX=/\$(([a-zA-Z_][a-zA-Z0-9_]*)(\.[a-zA-Z_][a-zA-Z0-9_]*)*(\[[^\]]+\]*)*)/gi,ATTRI_REGEX=/(?:[\s]*(?:([^=\s]+?)\s*=\s*)?(?:(?:"([^"\\]*)"|'([^'\\]*)'|([^\s'"]+)+)))+?/gi;Parser.openEachTag=0,Parser.openLiteralTag=0,Parser.prototype.parse=function(e){this._reMarker=e||{},this._output="var _out=[];";for(var t=0;this._tokens.length>t;t++){var r=this._tokens[t];if("/literal"!=r.expr)if("text"==r.type||Parser.openLiteralTag>0)this._output+="_out.push('"+removeUnsafe(r.matched)+"');\r\n";else{var a=r.expr;a="elseif"==a?"if":a;var n=r.value;this._output+=this.functions[a]?this.functions[a].call(this,r.matched,this.getAttributes(n)):"_out.push($util.value("+$smarty.expr(a+r.value,Parser.openEachTag)+"));\r\n"}else this.functions[r.expr].call(this,n,this.getAttributes(n))}return this._output},Parser.prototype.getAttributes=function(e){if(!e)return[];for(var t,r=0,a={};t=ATTRI_REGEX.exec(" "+e);){var n,s;t[1]===void 0?(n=r,s=t[0].replace(/^\s+|\s+$/g,""),r++):(n=t[1],s=t[2]||t[3]||t[4]),a[n]=s}return e=a},Parser.prototype.needSkip=function(e){var t=!1;switch(e){case"":case"index":case"input":case"__proto__":t=!0}return t},Parser.prototype.functions={"*":function(){return""},"/foreach":function(){var e=[];return e.push("}/*for end*/}/*if end*/"),e.push("}();"),Parser.openEachTag--,e.join("\r\n")},include:function(content,attributes){if(void 0==attributes.file)return"include语法错误"+content;if("node"==env)return"include语法不被支持";var var_file,var_assign;for(var arg_name in attributes){var arg_value=attributes[arg_name];if("file"!=arg_name)if("assign"!=arg_name){if(0==arg_value.indexOf("$")){var nativeKey=$smarty.expr(arg_value);attributes[arg_name]=eval("this._vars."+nativeKey)}}else var_assign=arg_value;else var_file=arg_value,delete attributes[arg_name]}var url=path.normalize(path.join(this._reMarker._basePath,var_file)),content=fetch(url,this._reMarker._basePath,attributes);return this._reMarker.setIncluded(url),var_assign?(this._vars[var_assign]=content,"var "+var_assign+"='"+removeUnsafe(content)+"';"):"_out.push('"+removeUnsafe(content)+"');"},assign:function(e,t){if(t["var"]===void 0||t.value===void 0)return"assign语法错误"+e;var r=t.value;"[]"===r&&(r={});var a=t["var"].replace(/'|"/gi,"");return this._vars[a]=r,"var "+a+'="'+$smarty.expr(t.value)+'";'},foreachelse:function(){return"}}else{{"},foreach:function(e,t){var r=t.from,a=t.item;if(!r&&!a)return"assign语法错误"+e;var n=t.key||"k"+Math.round(1e4*Math.random()),s=t.name||Math.round(1e4*Math.random()),i=[];return i.push("~function(){"),i.push('if(Object.prototype.toString.call({$var})==="[object Array]" && {$var}.length>0){ '.replace(/\{\$var\}/gi,$smarty.expr(r))),i.push("var iter=0;var length = 0;for (var k in "+$smarty.expr(r)+") {++length;}"),i.push("for (var i in "+$smarty.expr(r)+") {"),i.push("var smarty={};smarty.foreach={};"),i.push('smarty.foreach["'+s+'"] ={};'),i.push('smarty.foreach["'+s+'"].index= iter;'),i.push('smarty.foreach["'+s+'"].iteration= iter+1;'),i.push('smarty.foreach["'+s+'"].first= iter==0;'),i.push('smarty.foreach["'+s+'"].last= iter==length-1;'),i.push('smarty.foreach["'+s+'"].total= length;'),i.push("var "+a+"= "+$smarty.expr(r)+"[i];"),n&&i.push(n+"= i;"),i.push("iter++;"),Parser.openEachTag++,i.join("\r\n")},"/if":function(){return"};"},"else":function(){return"}else{"},"if":function(e,t){var r,a,n,s,i,o,u="",c=function(){a="",n=!1,s="",i="",o="== 0"},h=function(){a=n?"("+a+s+") "+i+o:a,u+=a};c();for(var f in t)if(!this.needSkip(f)&&(r=t[f],!this.needSkip(r)))switch(r){case"is":n=!0;break;case"not":o="== 0"===o?"!= 0":"== 0";break;case"div":break;case"even":i="% 2 ";break;case"odd":o="== 0"===o?"!= 0":"== 0",i="% 2 ";break;case"by":s+=" / ";break;case"||":case"&&":h(),u+=r+" ",c();break;default:this.operators[r]!==void 0?a+=this.operators[r]+" ":n?s+=r+" ":a+=$smarty.expr(r)+" "}h();var p="if("+u+"){";return e.match(/\{elseif\s+[^\}]*\}/i)&&(p="}else if("+u+"){"),p},literal:function(){return Parser.openLiteralTag++,""},"/literal":function(){return Parser.openLiteralTag--,""}},Parser.prototype.buildTagMatch=function(e,t){var r="";return e instanceof RegExp&&(e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e=e.source),r=r||t||"",RegExp(escapeRegExp(this._reMarker.startTag)+escapeRegExp(e)+escapeRegExp(this._reMarker.endTag),r)},Parser.prototype.operators={eq:"==",ne:"!=",neq:"!=",gt:">",lt:"<",ge:">=",gte:">=",le:"<=",lte:"<=",and:"&&",or:"||",mod:"%","==":"==","===":"===","!=":"!=",">":">","<":"<",">=":">=","<=":"<=","!":"!","%":"%","(":"(",")":")",0:0,"false":!1,"null":null,undefined:null}}),function(e){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t)}else if("function"==typeof define&&define.amd)define(["exports"],e);else{for(var r=document.getElementsByTagName("script"),a=[],n=0;r.length>n;n++)"remark-template"==r[n].getAttribute("type")&&a.push(r[n]);for(var s=0;a.length>s;s++){var i="__"+a[s].id+"__";window[i]=(new window.NC.reMarker).proc(a[s].innerHTML)}}}(function(){});