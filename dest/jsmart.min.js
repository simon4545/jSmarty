/*! jSmarty 2014-03-21 */
(function(e){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t,"node")}else"function"==typeof define&&define.amd?define(["exports"],e):e(window.NC={})})(function(exports,env){function escapeRegExp(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function removeUnsafe(e){var t=e.replace(/([\r\n])/gi,"\\n").replace(/\s{2,}/gi," ").replace(/\'/gi,"\\'");return t}function strtotime(e,t){function r(e,t,r){var n,a=c[t];a!==void 0&&(n=a-u.getDay(),0===n?n=7*r:n>0&&"last"===e?n-=7:0>n&&"next"===e&&(n+=7),u.setDate(u.getDate()+n))}function n(e){var t=e.split(" "),n=t[0],a=t[1].substring(0,3),i=/\d+/.test(n),s="ago"===t[2],o=("last"===n?-1:1)*(s?-1:1);if(i&&(o*=parseInt(n,10)),h.hasOwnProperty(a)&&!t[1].match(/^mon(day|\.)?$/i))return u["set"+h[a]](u["get"+h[a]]()+o);if("wee"===a)return u.setDate(u.getDate()+7*o);if("next"===n||"last"===n)r(n,a,o);else if(!i)return!1;return!0}var a,i,s,o,u,c,h,f,l,p,g,d=!1;if(!e)return d;if(e=e.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase(),i=e.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/),i&&i[2]===i[4])if(i[1]>1901)switch(i[2]){case"-":return i[3]>12||i[5]>31?d:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return d;case"/":return i[3]>12||i[5]>31?d:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else if(i[5]>1901)switch(i[2]){case"-":return i[3]>12||i[1]>31?d:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return i[3]>12||i[1]>31?d:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case"/":return i[1]>12||i[3]>31?d:new Date(i[5],parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else switch(i[2]){case"-":return i[3]>12||i[5]>31||70>i[1]&&i[1]>38?d:(o=i[1]>=0&&38>=i[1]?+i[1]+2e3:i[1],new Date(o,parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case".":return i[5]>=70?i[3]>12||i[1]>31?d:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3:60>i[5]&&!i[6]?i[1]>23||i[3]>59?d:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0,i[9]||0)/1e3):d;case"/":return i[1]>12||i[3]>31||70>i[5]&&i[5]>38?d:(o=i[5]>=0&&38>=i[5]?+i[5]+2e3:i[5],new Date(o,parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case":":return i[1]>23||i[3]>59||i[5]>59?d:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0)/1e3)}if("now"===e)return null===t||isNaN(t)?0|(new Date).getTime()/1e3:0|t;if(!isNaN(a=Date.parse(e)))return 0|a/1e3;if(u=t?new Date(1e3*t):new Date,c={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},h={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"},l="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)",p="([+-]?\\d+\\s"+l+"|"+"(last|next)\\s"+l+")(\\sago)?",i=e.match(RegExp(p,"gi")),!i)return d;for(g=0,f=i.length;f>g;g++)if(!n(i[g]))return d;return u.getTime()/1e3}function number_format(e,t,r,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,i=isFinite(+t)?Math.abs(t):0,s=n===void 0?",":n,o=r===void 0?".":r,u="",c=function(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r};return u=(i?c(a,i):""+Math.round(a)).split("."),u[0].length>3&&(u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),i>(u[1]||"").length&&(u[1]=u[1]||"",u[1]+=Array(i-u[1].length+1).join("0")),u.join(o)}function sprintf(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,r=0,n=t[r++],a=function(e,t,r,n){r||(r=" ");var a=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return n?e+a:a+e},i=function(e,t,r,n,i,s){var o=n-e.length;return o>0&&(e=r||!i?a(e,n,s,r):e.slice(0,t.length)+a("",o,"0",!0)+e.slice(t.length)),e},s=function(e,t,r,n,s,o,u){var c=e>>>0;return r=r&&c&&{2:"0b",8:"0",16:"0x"}[t]||"",e=r+a(c.toString(t),o||0,"0",!1),i(e,r,n,s,u)},o=function(e,t,r,n,a,s){return null!=n&&(e=e.slice(0,n)),i(e,"",t,r,a,s)},u=function(e,n,u,c,h,f,l){var p,g,d,v,m;if("%%"===e)return"%";for(var _=!1,y="",x=!1,b=!1,w=" ",k=u.length,M=0;u&&k>M;M++)switch(u.charAt(M)){case" ":y=" ";break;case"+":y="+";break;case"-":_=!0;break;case"'":w=u.charAt(M+1);break;case"0":x=!0,w="0";break;case"#":b=!0}if(c=c?"*"===c?+t[r++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:0,0>c&&(c=-c,_=!0),!isFinite(c))throw Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"===f?+t[r++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(l)>-1?6:"d"===l?0:void 0,m=n?t[n.slice(0,-1)]:t[r++],l){case"s":return o(m+"",_,c,f,x,w);case"c":return o(String.fromCharCode(+m),_,c,f,x);case"b":return s(m,2,b,_,c,f,x);case"o":return s(m,8,b,_,c,f,x);case"x":return s(m,16,b,_,c,f,x);case"X":return s(m,16,b,_,c,f,x).toUpperCase();case"u":return s(m,10,b,_,c,f,x);case"i":case"d":return p=+m||0,p=Math.round(p-p%1),g=0>p?"-":y,m=g+a(Math.abs(p)+"",f,"0",!1),i(m,g,_,c,x);case"e":case"E":case"f":case"F":case"g":case"G":return p=+m,g=0>p?"-":y,d=["toExponential","toFixed","toPrecision"]["efg".indexOf(l.toLowerCase())],v=["toString","toUpperCase"]["eEfFgG".indexOf(l)%2],m=g+Math.abs(p)[d](f),i(m,g,_,c,x)[v]();default:return e}};return n.replace(e,u)}function fetch(e,t,r){var n,a="";n=fs.getContentText(e);for(var i=/<!--\s*template\s*-->([\s|\S]*?)<!--\s*\/template\s*-->/gi,s=n.match(i);s=i.exec(n);)a+=s[1];var a=filter.HTMLFilter(a,e,t,r);return a}function Parser(e,t){this._tokens=e,this._output="",this._vars=t||{}}var strftime=function(){function e(t,n){return(n+"").replace(/%([a-zA-Z ])/g,function(n,a){var i=r&&r[a];return"function"==typeof i?i.call(r,t):"string"==typeof i?e(i):a})}function t(e){return(10>+e?"0":"")+e}var r={d:function(e){return t(e.getDate())},m:function(e){return t(e.getMonth()+1)},y:function(e){return e.getYear()%100},Y:function(e){return e.getFullYear()},F:"%Y-%m-%d",D:"%m/%d/%y"};return e}(),nc=exports!==void 0?exports:{},fs,path,filter,util;"node"==env&&(fs=require("./file"),path=require("path"),filter=require("./pages"),util=require("./util"));var ObjProto=Object.prototype,toString=ObjProto.toString,reMarker=function(){this._tokens=[],this._included=[],this._basePath="",this._vars={}};reMarker.prototype.startTag="{",reMarker.prototype.endTag="}",reMarker.prototype.setBasePath=function(e){return this._basePath=e,this},reMarker.prototype.setIncluded=function(e){return this._included.push(e),this},reMarker.prototype.getIncluded=function(){return this._included},reMarker.prototype.parse=function(e){for(var t,r=escapeRegExp(this.startTag)+"(?:\\s*)((?:[\\/\\$\"\\'])*[\\w\\*\"\\']+)(?:\\s*)(.*?)(?:\\1*)(?:\\s*)"+escapeRegExp(this.endTag),n=RegExp(r,"gim"),a=[],i=0;t=n.exec(e);)i!=t.index&&a.push({type:"text",value:e.substring(i,t.index),matched:e.substring(i,t.index),index:i}),a.push({type:"expression",expr:t[1],value:t[2],matched:t[0],index:t.index}),i=t.index+t[0].length;return a.push({type:"text",value:e.substring(i),matched:e.substring(i),index:i}),this.parser=new Parser(a,this._vars),this.parser.parse(this)},reMarker.prototype.proc=function(e,t){var r,n;try{this._vars=t,n=this.parse(e),r=Function("$data","$util",n+';return _out.join("");')}catch(a){throw Error("模板解析出错"+a.message)}if(!t)return function(e){var t=$smarty;return r(e,t)};var i=r.call(this,t,$smarty);return i};var $smarty={date_format:function(e,t,r){if(!e&&!r)return"date_format语法错误";var n=e||r;"number"!=typeof n&&(n=strtotime(n));var a=strftime(new Date(n),t||"%Y/%m/%d");return a},truncate:function(e,t,r,n,a){return t=t?t:80,r=null!=r?r:"...",t>=e.length?e:(t-=Math.min(t,r.length),a?e.slice(0,Math.floor(t/2))+r+e.slice(e.length-Math.floor(t/2)):(n||(e=e.slice(0,t+1).replace(/\s+?(\S+)?$/,"")),e.slice(0,t)+r))},"default":function(e,t){return e||t||""},spacify:function(e,t){return t||(t=" "),e.replace(/(\n|.)(?!$)/g,"$1"+t)},nl2br:function(e){return e.replace(/\n/g,"<br />\n")},capitalize:function(e,t){var r=RegExp(t?"[\\W\\d]+":"\\W+"),n=null,a="";for(n=e.match(r);n;n=e.match(r)){var i=e.slice(0,n.index);a+=i.match(/\d/)?i:i.charAt(0).toUpperCase()+i.slice(1),a+=e.slice(n.index,n.index+n[0].length),e=e.slice(n.index+n[0].length)}return e.match(/\d/)?a+e:a+e.charAt(0).toUpperCase()+e.slice(1)},upper:function(e){return e.toUpperCase()},wordwrap:function(e,t,r,n){t=t||80,r=r||"\n";for(var a=e.split("\n"),i=0;a.length>i;++i){for(var s=a[i],o="";s.length>t;){for(var u=0,c=s.slice(u).match(/\s+/);c&&t>=u+c.index;c=s.slice(u).match(/\s+/))u+=c.index+c[0].length;u=u||(n?t:c?c.index+c[0].length:s.length),o+=s.slice(0,u).replace(/\s+$/,""),s.length>u&&(o+=r),s=s.slice(u)}a[i]=o+s}return a.join("\n")},cat:function(e,t){return t=t?t:"",e+t},count_paragraphs:function(e){var t=e.match(/\n+/g);return t?t.length+1:1},count_sentences:function(e){var t=e.match(/[^\s]\.(?!\w)/g);return t?t.length:0},lower:function(e){return e.toLowerCase()},count_words:function(e){var t=e.match(/\w+/g);return t?t.length:0},indent:function(e,t,r){t=t?t:4,r=r?r:" ";for(var n="";t--;)n+=r;var a=e.match(/\n+$/);return n+e.replace(/\n+$/,"").replace(/\n/g,"\n"+n)+(a?a[0]:"")},replace:function(e,t,r){if(!t)return e;e=new String(e),t=new String(t),r=new String(r);var n="",a=-1;for(a=e.indexOf(t);a>=0;a=e.indexOf(t))n+=e.slice(0,a)+r,a+=t.length,e=e.slice(a);return n+e},regex_replace:function(e,t,r){var n=t.match(/^ *\/(.*)\/(.*) *$/);return new String(e).replace(RegExp(n[1],"g"+(n.length>1?n[2]:"")),r)},noprint:function(){return""},strip:function(e,t){return t=t?t:" ",new String(e).replace(/[\s]+/g,t)},strip_tags:function(e,t){return t=null==t?!0:t,new String(e).replace(/<[^>]*?>/g,t?" ":"")},string_format:function(e,t){return sprintf(t,e)},fsize_format:function(e,t,r){t=t||"",r=r||2;var n={TB:1099511627776,GB:1073741824,MB:1048576,KB:1024,B:1},a="";for(var i in n)if(e>n[i]||i==this.upper(t)){a=number_format(e/n[i],r)+" "+i;break}return a}};$smarty.expr=function(e,t){function r(e){if(!a[e])return"";for(var t=[],r=e;a.length>r&&!a[r].modifier;r++)t.push(a[r].string||a[r].num);return s=r-1,0!=t.length&&t.unshift(""),t.join(",")}var n=new TextReader(e),a=n.read();if(1>a.length)return e;var i;if(i=a[0].string||a[0].num?a[0].string||a[0].num:t?a[0]["var"]:"$data."+a[0]["var"],a.length>1)for(var s=1;a.length>s;s++){var o=$smarty[a[s].modifier];o&&(i="$util."+a[s].modifier+"("+i+r(s+1)+")")}return i},$smarty.value=function(e){return"[object Object]"===toString.call(e)||"[object Array]"===toString.call(e)?JSON.stringify(e):e},nc.reMarker=reMarker;var TextReader=function(e){this.inChars=e||"",this.words=[]};TextReader.prototype={start:0,end:0,VAR_REGEXP:/[\w\d_\-\.\[\]\'\"]/i,read:function(){for(var e=this.inChars.length;e>=this.start;this.start++)switch(this.inChars.charAt(this.start)){case"	":case"\r":case" ":break;case"@":continue;case"|":this.start=this.findModifier(this.start+1);continue;case"$":this.start=this.findVariable(this.start+1);continue;case'"':case"'":this.start=this.findString(this.start+1);continue;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this.start=this.findNumber(this.start);continue;case":":continue}return this.words},skip:function(){},checkVariable:function(e){return e.match(this.VAR_REGEXP)},checkModifier:function(e){return":"!=e},findNumber:function(e){for(var t=this.inChars.length,r="",n=e;t>n;n++){var a=this.inChars.charAt(n);if(!(r.length>0&&"."===a||parseInt(a)==a)){n--;break}r+=a}return this.words.push({num:r}),n},findVariable:function(e){for(var t=this.inChars.length,r="",n=e;t>n;n++){var a=this.inChars.charAt(n);if(!this.checkVariable(a)){n--;break}r+=a}return this.words.push({"var":r}),n},findString:function(e){for(var t=this.inChars.length,r="",n=e;t>n;n++){var a=this.inChars.charAt(n);if("'"!=a&&'"'!=a)r+=a;else{if("\\"!=a||"'"!=this.inChars.charAt(n+1)&&'"'!=this.inChars.charAt(n+1))break;r+="\\'",n++}}return this.words.push({string:"'"+r+"'"}),n},findModifier:function(e){for(var t=this.inChars.length,r="",n=e;t>n;n++){var a=this.inChars.charAt(n);if(!this.checkModifier(a)){n--;break}r+=a}return this.words.push({modifier:r}),n}};var VAR_REGEX=/\$(([a-zA-Z_][a-zA-Z0-9_]*)(\.[a-zA-Z_][a-zA-Z0-9_]*)*(\[[^\]]+\]*)*)/gi,ATTRI_REGEX=/(?:[\s]*(?:([^=\s]+?)\s*=\s*)?(?:(?:"([^"\\]*)"|'([^'\\]*)'|([^\s'"]+)+)))+?/gi;Parser.openEachTag=0,Parser.openLiteralTag=0,Parser.prototype.parse=function(e){this._reMarker=e||{},this._output="var _out=[];";for(var t=0;this._tokens.length>t;t++){var r=this._tokens[t];if("/literal"!=r.expr)if("text"==r.type||Parser.openLiteralTag>0)this._output+="_out.push('"+removeUnsafe(r.matched)+"');\r\n";else{var n=r.expr;n="elseif"==n?"if":n;var a=r.value;if(this.functions[n])this._output+=this.functions[n].call(this,r.matched,this.getAttributes(a));else{var i=r.matched.substring(this._reMarker.startTag.length,r.matched.length-this._reMarker.endTag.length);this._output+="_out.push($util.value("+$smarty.expr(i,Parser.openEachTag)+"));\r\n"}}else this.functions[r.expr].call(this,a,this.getAttributes(a))}return this._output},Parser.prototype.getAttributes=function(e){if(!e)return[];for(var t,r=0,n={};t=ATTRI_REGEX.exec(" "+e);){var a,i;t[1]===void 0?(a=r,i=t[0].replace(/^\s+|\s+$/g,""),r++):(a=t[1],i=t[2]||t[3]||t[4]),n[a]=i}return e=n},Parser.prototype.needSkip=function(e){var t=!1;switch(e){case"":case"index":case"input":case"__proto__":t=!0}return t},Parser.prototype.functions={"*":function(){return""},"/foreach":function(){var e=[];return e.push("}/*for end*/}/*if end*/"),e.push("}();"),Parser.openEachTag--,e.join("\r\n")},include:function(content,attributes){if(void 0==attributes.file)return"include语法错误"+content;if("node"==env)return"include语法不被支持";var var_file,var_assign;for(var arg_name in attributes){var arg_value=attributes[arg_name];if("file"!=arg_name)if("assign"!=arg_name){if(0==arg_value.indexOf("$")){var nativeKey=$smarty.expr(arg_value);attributes[arg_name]=eval("this._vars."+nativeKey)}}else var_assign=arg_value;else var_file=arg_value,delete attributes[arg_name]}var url=path.normalize(path.join(this._reMarker._basePath,var_file)),content=fetch(url,this._reMarker._basePath,attributes);return this._reMarker.setIncluded(url),var_assign?(this._vars[var_assign]=content,"var "+var_assign+"='"+removeUnsafe(content)+"';"):"_out.push('"+removeUnsafe(content)+"');"},assign:function(e,t){if(t["var"]===void 0||t.value===void 0)return"assign语法错误"+e;var r=t.value;"[]"===r&&(r={});var n=t["var"].replace(/'|"/gi,"");return this._vars[n]=r,"var "+n+'="'+$smarty.expr(t.value)+'";'},foreachelse:function(){return"}}else{{"},foreach:function(e,t){var r=t.from,n=t.item;if(!r&&!n)return"assign语法错误"+e;var a=t.key||"k"+Math.round(1e4*Math.random()),i=t.name||Math.round(1e4*Math.random()),s=[];return s.push("~function(){"),s.push('if(Object.prototype.toString.call({$var})==="[object Array]" && {$var}.length>0){ '.replace(/\{\$var\}/gi,$smarty.expr(r))),s.push("var iter=0;var length = 0;for (var k in "+$smarty.expr(r)+") {++length;}"),s.push("for (var i in "+$smarty.expr(r)+") {"),s.push("var smarty={};smarty.foreach={};"),s.push('smarty.foreach["'+i+'"] ={};'),s.push('smarty.foreach["'+i+'"].index= iter;'),s.push('smarty.foreach["'+i+'"].iteration= iter+1;'),s.push('smarty.foreach["'+i+'"].first= iter==0;'),s.push('smarty.foreach["'+i+'"].last= iter==length-1;'),s.push('smarty.foreach["'+i+'"].total= length;'),s.push("var "+n+"= "+$smarty.expr(r)+"[i];"),a&&s.push(a+"= i;"),s.push("iter++;"),Parser.openEachTag++,s.join("\r\n")},"/if":function(){return"};"},"else":function(){return"}else{"},"if":function(e,t){var r,n,a,i,s,o,u="",c=function(){n="",a=!1,i="",s="",o="== 0"},h=function(){n=a?"("+n+i+") "+s+o:n,u+=n};c();for(var f in t)if(!this.needSkip(f)&&(r=t[f],!this.needSkip(r)))switch(r){case"is":a=!0;break;case"not":o="== 0"===o?"!= 0":"== 0";break;case"div":break;case"even":s="% 2 ";break;case"odd":o="== 0"===o?"!= 0":"== 0",s="% 2 ";break;case"by":i+=" / ";break;case"||":case"&&":h(),u+=r+" ",c();break;default:this.operators[r]!==void 0?n+=this.operators[r]+" ":a?i+=r+" ":n+=$smarty.expr(r)+" "}h();var l="if("+u+"){";return e.match(/\{elseif\s+[^\}]*\}/i)&&(l="}else if("+u+"){"),l},literal:function(){return Parser.openLiteralTag++,""},"/literal":function(){return Parser.openLiteralTag--,""}},Parser.prototype.buildTagMatch=function(e,t){var r="";return e instanceof RegExp&&(e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e=e.source),r=r||t||"",RegExp(escapeRegExp(this._reMarker.startTag)+escapeRegExp(e)+escapeRegExp(this._reMarker.endTag),r)},Parser.prototype.operators={eq:"==",ne:"!=",neq:"!=",gt:">",lt:"<",ge:">=",gte:">=",le:"<=",lte:"<=",and:"&&",or:"||",mod:"%","==":"==","===":"===","!=":"!=",">":">","<":"<",">=":">=","<=":"<=","!":"!","%":"%","(":"(",")":")",0:0,"false":!1,"null":null,undefined:null}}),function(e){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t)}else if("function"==typeof define&&define.amd)define(["exports"],e);else{for(var r=document.getElementsByTagName("script"),n=[],a=0;r.length>a;a++)"remark-template"==r[a].getAttribute("type")&&n.push(r[a]);for(var i=0;n.length>i;i++){var s="__"+n[i].id+"__";window[s]=(new window.NC.reMarker).proc(n[i].innerHTML)}}}(function(){});